use strict;
use warnings;
use Test::More tests => 4;
use File::Temp;
use Math::BigInt try => 'GMP';

# CounterAppend uses time() and we can't get a deterministic output unless we
# overload it.  This overload needs to happen before use CIBH::DS::Datafile;
no warnings 'redefine';
my $time2 = 1425309835;
BEGIN {
    *CORE::GLOBAL::time = sub () {
        $time2;
    };
}

use CIBH::DS::Datafile qw ( $FORMAT $RECORDSIZE );

my $time1 = 1425309535;
my $spike = 10**11;

sub write_header {
    my $value1 = shift;
    my $tmpf = File::Temp->new();
    # the initial data for the file should be time1, value1, zero, value1.
    # the reason for this is that The first entry is time1, value1.  The last
    # record of a counterappend file is a record with a zero timestamp and the
    # current counter value.

    $tmpf->syswrite(pack($FORMAT . $FORMAT, $time1, $value1, 0, $value1), $RECORDSIZE*2);
    return $tmpf;
}


# even with testing code I'm not positive I've got this right...
subtest 'test a spike value' => sub {
    my $value1 = Math::BigInt->new('2_200_281_748_332');
    my $value2 = Math::BigInt->new('4_611_686_018_427_387_904');
    my $tmpf = write_header($value1);

    my $value = CIBH::DS::Datafile::CounterAppend($tmpf->filename, $value2, $spike, Math::BigInt->new(2)->bpow(64) );
    is($value, 0, 'Test spiked value should return 0bps');
    $time2 = 1425309835+300;
    $value = CIBH::DS::Datafile::CounterAppend($tmpf->filename, $value2+250_000, $spike, Math::BigInt->new(2)->bpow(64) );
    is($value, 833, 'Next write after spike with non-spike value should be 833bps');

    # test OO interface..
    my $data = CIBH::DS::Datafile->new(filename=>$tmpf->filename)->GetValues($time1-1, $time2+1);
    # currently I don't think this data looks right, but I need to examine the
    # code to decide if I'm right or wrong.
    is_deeply( $data, [ { '1425310135' => 833 } ], 'Does our stored data look correct when we read it back?' );

    # change time2 back to global value before leaving subtest
    $time2 = 1425309835;
    done_testing();
};


subtest 'test a non-spike value' => sub {
    my $value1 = Math::BigInt->new('2_200_281_748_332');
    my $value2 = Math::BigInt->new('2_500_281_748_332');  # 300_000_000_000 higher than value1 (1Gbps)
    my $tmpf = write_header($value1);
    $tmpf->syswrite(pack($FORMAT . $FORMAT, $time1, $value1, 0, $value1), $RECORDSIZE*2);
    my $value = CIBH::DS::Datafile::CounterAppend($tmpf->filename, $value2, $spike, Math::BigInt->new(2)->bpow(64) );
    is($value, 1_000_000_000, 'NON-spike test, value should be 1Gbps');
    done_testing();
};

subtest 'test a wrap' => sub {
    my $value1 = Math::BigInt->new(2)->bpow(64);
    my $value2 = Math::BigInt->new('3_900_000_000');  # value2 is lower than value1, wrap happens
    my $tmpf = write_header($value1);

    my $value = CIBH::DS::Datafile::CounterAppend($tmpf->filename, $value2, $spike, Math::BigInt->new(2)->bpow(64) );
    is($value, 13_000_000, 'Normal wrap, value should be 13Mbps');
    done_testing();
};

subtest 'test Sample' => sub {

    my ($actual_avg,$actual_max) = eval  do { local $/; <DATA> };
    my $in = CIBH::DS::Datafile->new(filename => 't/data/test.out', scale => 1/500000000);
    my ($ave,$max,$aveval,$maxval,$last)=$in->Sample(1447036556,1447122956,1/600);
    is_deeply($ave,$actual_avg, 'Average array correct');
    is_deeply($max,$actual_max, 'Max array correct');
    is($aveval, '75151724.6909722', 'Average value correct');
    is($maxval,'241572202','Max value correct');
    is($last,'179712313','Last value correct');
    done_testing();
};

done_testing();

__DATA__
[
        [
          0,
          0.47814144
        ],
        [
          0.00333333333333333,
          0.468775202
        ],
        [
          0.00666666666666667,
          0.483144404
        ],
        [
          0.01,
          0.443882422
        ],
        [
          0.0133333333333333,
          0.442889966
        ],
        [
          0.0183333333333333,
          0.336235488
        ],
        [
          0.0216666666666667,
          0.340214614
        ],
        [
          0.025,
          0.32769156
        ],
        [
          0.0283333333333333,
          0.359374468
        ],
        [
          0.0316666666666667,
          0.382715822
        ],
        [
          0.035,
          0.375054256
        ],
        [
          0.0383333333333333,
          0.35224289
        ],
        [
          0.0416666666666667,
          0.349263464
        ],
        [
          0.045,
          0.30914415
        ],
        [
          0.0483333333333333,
          0.334584966
        ],
        [
          0.0516666666666666,
          0.29902251
        ],
        [
          0.055,
          0.279832642
        ],
        [
          0.0599999999999999,
          0.284255706
        ],
        [
          0.0633333333333333,
          0.297070234
        ],
        [
          0.0666666666666666,
          0.306657072
        ],
        [
          0.0699999999999999,
          0.297465566
        ],
        [
          0.0733333333333333,
          0.272818218
        ],
        [
          0.0766666666666666,
          0.286160962
        ],
        [
          0.0799999999999999,
          0.251586666
        ],
        [
          0.0833333333333332,
          0.240892842
        ],
        [
          0.0866666666666666,
          0.230238716
        ],
        [
          0.0899999999999999,
          0.237769646
        ],
        [
          0.0933333333333332,
          0.207807568
        ],
        [
          0.0966666666666666,
          0.217298902
        ],
        [
          0.101666666666667,
          0.214362674
        ],
        [
          0.105,
          0.209782662
        ],
        [
          0.108333333333333,
          0.224777534
        ],
        [
          0.111666666666667,
          0.21319365
        ],
        [
          0.115,
          0.324269606
        ],
        [
          0.118333333333333,
          0.219263126
        ],
        [
          0.121666666666667,
          0.194546316
        ],
        [
          0.125,
          0.207756618
        ],
        [
          0.128333333333333,
          0.172929472
        ],
        [
          0.131666666666667,
          0.182780346
        ],
        [
          0.135,
          0.179584532
        ],
        [
          0.138333333333333,
          0.162856762
        ],
        [
          0.143333333333333,
          0.163704798
        ],
        [
          0.146666666666667,
          0.161380228
        ],
        [
          0.15,
          0.160175974
        ],
        [
          0.153333333333333,
          0.185062158
        ],
        [
          0.156666666666667,
          0.156501116
        ],
        [
          0.16,
          0.171524416
        ],
        [
          0.163333333333333,
          0.162589916
        ],
        [
          0.166666666666667,
          0.15529472
        ],
        [
          0.17,
          0.167111548
        ],
        [
          0.173333333333333,
          0.167951828
        ],
        [
          0.176666666666667,
          0.164475608
        ],
        [
          0.18,
          0.146701958
        ],
        [
          0.185,
          0.120801648
        ],
        [
          0.188333333333334,
          0.114217992
        ],
        [
          0.191666666666667,
          0.112539488
        ],
        [
          0.195,
          0.11905313
        ],
        [
          0.198333333333334,
          0.12460736
        ],
        [
          0.201666666666667,
          0.123093296
        ],
        [
          0.205,
          0.110269132
        ],
        [
          0.208333333333334,
          0.120765036
        ],
        [
          0.211666666666667,
          0.105893816
        ],
        [
          0.215,
          0.09424045
        ],
        [
          0.218333333333334,
          0.076614088
        ],
        [
          0.221666666666667,
          0.07739623
        ],
        [
          0.226666666666667,
          0.078946576
        ],
        [
          0.230000000000001,
          0.079976458
        ],
        [
          0.233333333333334,
          0.076100766
        ],
        [
          0.236666666666667,
          0.086774174
        ],
        [
          0.240000000000001,
          0.093594542
        ],
        [
          0.243333333333334,
          0.074448894
        ],
        [
          0.246666666666667,
          0.076369792
        ],
        [
          0.250000000000001,
          0.083973044
        ],
        [
          0.253333333333334,
          0.082022078
        ],
        [
          0.256666666666667,
          0.076474416
        ],
        [
          0.260000000000001,
          0.081313352
        ],
        [
          0.263333333333334,
          0.079529446
        ],
        [
          0.268333333333334,
          0.074188616
        ],
        [
          0.271666666666667,
          0.06798402
        ],
        [
          0.275,
          0.065366752
        ],
        [
          0.278333333333334,
          0.066807312
        ],
        [
          0.281666666666667,
          0.066341754
        ],
        [
          0.285,
          0.066343104
        ],
        [
          0.288333333333334,
          0.064029504
        ],
        [
          0.291666666666667,
          0.069100432
        ],
        [
          0.295,
          0.060967866
        ],
        [
          0.298333333333333,
          0.051917474
        ],
        [
          0.301666666666667,
          0.061207936
        ],
        [
          0.305,
          0.059039946
        ],
        [
          0.31,
          0.067773752
        ],
        [
          0.313333333333333,
          0.056332928
        ],
        [
          0.316666666666667,
          0.056902252
        ],
        [
          0.32,
          0.050764324
        ],
        [
          0.323333333333333,
          0.049233802
        ],
        [
          0.326666666666666,
          0.059564972
        ],
        [
          0.33,
          0.071222702
        ],
        [
          0.333333333333333,
          0.054380582
        ],
        [
          0.336666666666666,
          0.071666786
        ],
        [
          0.34,
          0.067386364
        ],
        [
          0.343333333333333,
          0.074438776
        ],
        [
          0.346666666666666,
          0.086998242
        ],
        [
          0.351666666666666,
          0.048129172
        ],
        [
          0.355,
          0.042206844
        ],
        [
          0.358333333333333,
          0.034691292
        ],
        [
          0.361666666666666,
          0.036683826
        ],
        [
          0.364999999999999,
          0.038205592
        ],
        [
          0.368333333333333,
          0.044332328
        ],
        [
          0.371666666666666,
          0.041290568
        ],
        [
          0.374999999999999,
          0.041046944
        ],
        [
          0.378333333333333,
          0.04129468
        ],
        [
          0.381666666666666,
          0.048522646
        ],
        [
          0.384999999999999,
          0.04007642
        ],
        [
          0.388333333333333,
          0.035370972
        ],
        [
          0.393333333333332,
          0.058538648
        ],
        [
          0.396666666666666,
          0.068450208
        ],
        [
          0.399999999999999,
          0.05208389
        ],
        [
          0.403333333333332,
          0.063856682
        ],
        [
          0.406666666666666,
          0.079195466
        ],
        [
          0.409999999999999,
          0.060375056
        ],
        [
          0.413333333333332,
          0.05251243
        ],
        [
          0.416666666666666,
          0.057919474
        ],
        [
          0.419999999999999,
          0.062479528
        ],
        [
          0.423333333333332,
          0.085848632
        ],
        [
          0.426666666666665,
          0.068409902
        ],
        [
          0.429999999999999,
          0.070471764
        ],
        [
          0.434999999999999,
          0.064010884
        ],
        [
          0.438333333333332,
          0.070874764
        ],
        [
          0.441666666666665,
          0.085458458
        ],
        [
          0.444999999999999,
          0.1151598
        ],
        [
          0.448333333333332,
          0.098264886
        ],
        [
          0.451666666666665,
          0.103926196
        ],
        [
          0.454999999999999,
          0.096419676
        ],
        [
          0.458333333333332,
          0.099320694
        ],
        [
          0.461666666666665,
          0.081538298
        ],
        [
          0.464999999999998,
          0.087072224
        ],
        [
          0.468333333333332,
          0.086786226
        ],
        [
          0.471666666666665,
          0.090755578
        ],
        [
          0.476666666666665,
          0.0695923
        ],
        [
          0.479999999999998,
          0.072440268
        ],
        [
          0.483333333333332,
          0.070839146
        ],
        [
          0.486666666666665,
          0.111062614
        ],
        [
          0.489999999999998,
          0.120547588
        ],
        [
          0.493333333333331,
          0.114480012
        ],
        [
          0.496666666666665,
          0.147566356
        ],
        [
          0.499999999999998,
          0.141432184
        ],
        [
          0.503333333333331,
          0.13413587
        ],
        [
          0.506666666666665,
          0.138018584
        ],
        [
          0.509999999999998,
          0.092823864
        ],
        [
          0.513333333333332,
          0.101071188
        ],
        [
          0.518333333333332,
          0.105150416
        ],
        [
          0.521666666666665,
          0.102835436
        ],
        [
          0.524999999999999,
          0.105118922
        ],
        [
          0.528333333333332,
          0.098322628
        ],
        [
          0.531666666666665,
          0.09645792
        ],
        [
          0.534999999999999,
          0.094206554
        ],
        [
          0.538333333333332,
          0.092868584
        ],
        [
          0.541666666666666,
          0.099692152
        ],
        [
          0.544999999999999,
          0.091558858
        ],
        [
          0.548333333333332,
          0.080085784
        ],
        [
          0.551666666666666,
          0.084746874
        ],
        [
          0.554999999999999,
          0.07963973
        ],
        [
          0.559999999999999,
          0.08792069
        ],
        [
          0.563333333333333,
          0.097038344
        ],
        [
          0.566666666666666,
          0.087699246
        ],
        [
          0.57,
          0.08212368
        ],
        [
          0.573333333333333,
          0.085863792
        ],
        [
          0.576666666666666,
          0.094771162
        ],
        [
          0.58,
          0.09749201
        ],
        [
          0.583333333333333,
          0.080995894
        ],
        [
          0.586666666666667,
          0.081005096
        ],
        [
          0.59,
          0.08085049
        ],
        [
          0.593333333333333,
          0.097356396
        ],
        [
          0.596666666666667,
          0.09468653
        ],
        [
          0.601666666666667,
          0.075859148
        ],
        [
          0.605,
          0.10999774
        ],
        [
          0.608333333333334,
          0.095919028
        ],
        [
          0.611666666666667,
          0.097915224
        ],
        [
          0.615000000000001,
          0.113576766
        ],
        [
          0.618333333333334,
          0.098824102
        ],
        [
          0.621666666666667,
          0.130585866
        ],
        [
          0.625000000000001,
          0.096918352
        ],
        [
          0.628333333333334,
          0.089235268
        ],
        [
          0.631666666666668,
          0.123918744
        ],
        [
          0.635000000000001,
          0.10337368
        ],
        [
          0.638333333333335,
          0.099580396
        ],
        [
          0.643333333333335,
          0.10200415
        ],
        [
          0.646666666666668,
          0.106981894
        ],
        [
          0.650000000000001,
          0.091556734
        ],
        [
          0.653333333333335,
          0.084123812
        ],
        [
          0.656666666666668,
          0.118801852
        ],
        [
          0.660000000000002,
          0.132050904
        ],
        [
          0.663333333333335,
          0.129579634
        ],
        [
          0.666666666666669,
          0.119702398
        ],
        [
          0.670000000000002,
          0.138579668
        ],
        [
          0.673333333333335,
          0.129004628
        ],
        [
          0.676666666666669,
          0.114568892
        ],
        [
          0.680000000000002,
          0.11784425
        ],
        [
          0.685000000000002,
          0.106929028
        ],
        [
          0.688333333333336,
          0.096616004
        ],
        [
          0.691666666666669,
          0.090910354
        ],
        [
          0.695000000000003,
          0.103817442
        ],
        [
          0.698333333333336,
          0.092505858
        ],
        [
          0.701666666666669,
          0.131531098
        ],
        [
          0.705000000000003,
          0.129488188
        ],
        [
          0.708333333333336,
          0.084743372
        ],
        [
          0.71166666666667,
          0.087353054
        ],
        [
          0.715000000000003,
          0.103165322
        ],
        [
          0.718333333333336,
          0.077734212
        ],
        [
          0.72166666666667,
          0.094839706
        ],
        [
          0.72666666666667,
          0.107274464
        ],
        [
          0.730000000000003,
          0.099738008
        ],
        [
          0.733333333333337,
          0.081031946
        ],
        [
          0.73666666666667,
          0.160459944
        ],
        [
          0.740000000000004,
          0.133538788
        ],
        [
          0.743333333333337,
          0.08815583
        ],
        [
          0.74666666666667,
          0.097820664
        ],
        [
          0.750000000000004,
          0.113520894
        ],
        [
          0.753333333333337,
          0.099954742
        ],
        [
          0.756666666666671,
          0.090291362
        ],
        [
          0.760000000000004,
          0.093785216
        ],
        [
          0.763333333333337,
          0.100113252
        ],
        [
          0.768333333333338,
          0.09699985
        ],
        [
          0.771666666666671,
          0.099903698
        ],
        [
          0.775000000000004,
          0.126074604
        ],
        [
          0.778333333333338,
          0.086607852
        ],
        [
          0.781666666666671,
          0.078836908
        ],
        [
          0.785000000000005,
          0.071114846
        ],
        [
          0.788333333333338,
          0.071949132
        ],
        [
          0.791666666666671,
          0.05608937
        ],
        [
          0.795000000000005,
          0.071777246
        ],
        [
          0.798333333333338,
          0.074240064
        ],
        [
          0.801666666666672,
          0.09303625
        ],
        [
          0.805000000000005,
          0.083338716
        ],
        [
          0.810000000000005,
          0.083282054
        ],
        [
          0.813333333333339,
          0.110499292
        ],
        [
          0.816666666666672,
          0.09737593
        ],
        [
          0.820000000000005,
          0.110887764
        ],
        [
          0.823333333333339,
          0.135147224
        ],
        [
          0.826666666666672,
          0.137772206
        ],
        [
          0.830000000000006,
          0.155075366
        ],
        [
          0.833333333333339,
          0.153389322
        ],
        [
          0.836666666666672,
          0.167513334
        ],
        [
          0.840000000000006,
          0.137224728
        ],
        [
          0.843333333333339,
          0.125763046
        ],
        [
          0.846666666666673,
          0.123717714
        ],
        [
          0.851666666666673,
          0.136590558
        ],
        [
          0.855000000000006,
          0.144672078
        ],
        [
          0.85833333333334,
          0.14381943
        ],
        [
          0.861666666666673,
          0.136227102
        ],
        [
          0.865000000000006,
          0.136748542
        ],
        [
          0.86833333333334,
          0.138102316
        ],
        [
          0.871666666666673,
          0.125249176
        ],
        [
          0.875000000000007,
          0.179608978
        ],
        [
          0.87833333333334,
          0.17069586
        ],
        [
          0.881666666666673,
          0.153176172
        ],
        [
          0.885000000000007,
          0.188610348
        ],
        [
          0.88833333333334,
          0.207331748
        ],
        [
          0.89333333333334,
          0.204508232
        ],
        [
          0.896666666666674,
          0.228725022
        ],
        [
          0.900000000000007,
          0.279220428
        ],
        [
          0.903333333333341,
          0.279117122
        ],
        [
          0.906666666666674,
          0.29583066
        ],
        [
          0.910000000000007,
          0.279256286
        ],
        [
          0.913333333333341,
          0.306865292
        ],
        [
          0.916666666666674,
          0.361426456
        ],
        [
          0.920000000000008,
          0.335420924
        ],
        [
          0.923333333333341,
          0.34725681
        ],
        [
          0.926666666666675,
          0.428732626
        ],
        [
          0.930000000000008,
          0.361122366
        ],
        [
          0.935000000000008,
          0.34623368
        ],
        [
          0.938333333333341,
          0.327635116
        ],
        [
          0.941666666666675,
          0.287698668
        ],
        [
          0.945000000000008,
          0.324826034
        ],
        [
          0.948333333333342,
          0.340163734
        ],
        [
          0.951666666666675,
          0.375091534
        ],
        [
          0.955000000000009,
          0.36357243
        ],
        [
          0.958333333333342,
          0.406812058
        ],
        [
          0.961666666666675,
          0.408987516
        ],
        [
          0.965000000000009,
          0.402750944
        ],
        [
          0.968333333333342,
          0.329371778
        ],
        [
          0.971666666666676,
          0.28141041
        ],
        [
          0.976666666666676,
          0.305862584
        ],
        [
          0.980000000000009,
          0.308614434
        ],
        [
          0.983333333333342,
          0.326867658
        ],
        [
          0.986666666666676,
          0.320981404
        ],
        [
          0.990000000000009,
          0.325478032
        ],
        [
          0.993333333333343,
          0.309994716
        ],
        [
          0.996666666666676,
          0.359424626
        ]
],
[
        [
          0,
          0.47814144
        ],
        [
          0.00333333333333333,
          0.468775202
        ],
        [
          0.00666666666666667,
          0.483144404
        ],
        [
          0.01,
          0.443882422
        ],
        [
          0.0133333333333333,
          0.442889966
        ],
        [
          0.0183333333333333,
          0.336235488
        ],
        [
          0.0216666666666667,
          0.340214614
        ],
        [
          0.025,
          0.32769156
        ],
        [
          0.0283333333333333,
          0.359374468
        ],
        [
          0.0316666666666667,
          0.382715822
        ],
        [
          0.035,
          0.375054256
        ],
        [
          0.0383333333333333,
          0.35224289
        ],
        [
          0.0416666666666667,
          0.349263464
        ],
        [
          0.045,
          0.30914415
        ],
        [
          0.0483333333333333,
          0.334584966
        ],
        [
          0.0516666666666666,
          0.29902251
        ],
        [
          0.055,
          0.279832642
        ],
        [
          0.0599999999999999,
          0.284255706
        ],
        [
          0.0633333333333333,
          0.297070234
        ],
        [
          0.0666666666666666,
          0.306657072
        ],
        [
          0.0699999999999999,
          0.297465566
        ],
        [
          0.0733333333333333,
          0.272818218
        ],
        [
          0.0766666666666666,
          0.286160962
        ],
        [
          0.0799999999999999,
          0.251586666
        ],
        [
          0.0833333333333332,
          0.240892842
        ],
        [
          0.0866666666666666,
          0.230238716
        ],
        [
          0.0899999999999999,
          0.237769646
        ],
        [
          0.0933333333333332,
          0.207807568
        ],
        [
          0.0966666666666666,
          0.217298902
        ],
        [
          0.101666666666667,
          0.214362674
        ],
        [
          0.105,
          0.209782662
        ],
        [
          0.108333333333333,
          0.224777534
        ],
        [
          0.111666666666667,
          0.21319365
        ],
        [
          0.115,
          0.324269606
        ],
        [
          0.118333333333333,
          0.219263126
        ],
        [
          0.121666666666667,
          0.194546316
        ],
        [
          0.125,
          0.207756618
        ],
        [
          0.128333333333333,
          0.172929472
        ],
        [
          0.131666666666667,
          0.182780346
        ],
        [
          0.135,
          0.179584532
        ],
        [
          0.138333333333333,
          0.162856762
        ],
        [
          0.143333333333333,
          0.163704798
        ],
        [
          0.146666666666667,
          0.161380228
        ],
        [
          0.15,
          0.160175974
        ],
        [
          0.153333333333333,
          0.185062158
        ],
        [
          0.156666666666667,
          0.156501116
        ],
        [
          0.16,
          0.171524416
        ],
        [
          0.163333333333333,
          0.162589916
        ],
        [
          0.166666666666667,
          0.15529472
        ],
        [
          0.17,
          0.167111548
        ],
        [
          0.173333333333333,
          0.167951828
        ],
        [
          0.176666666666667,
          0.164475608
        ],
        [
          0.18,
          0.146701958
        ],
        [
          0.185,
          0.120801648
        ],
        [
          0.188333333333334,
          0.114217992
        ],
        [
          0.191666666666667,
          0.112539488
        ],
        [
          0.195,
          0.11905313
        ],
        [
          0.198333333333334,
          0.12460736
        ],
        [
          0.201666666666667,
          0.123093296
        ],
        [
          0.205,
          0.110269132
        ],
        [
          0.208333333333334,
          0.120765036
        ],
        [
          0.211666666666667,
          0.105893816
        ],
        [
          0.215,
          0.09424045
        ],
        [
          0.218333333333334,
          0.076614088
        ],
        [
          0.221666666666667,
          0.07739623
        ],
        [
          0.226666666666667,
          0.078946576
        ],
        [
          0.230000000000001,
          0.079976458
        ],
        [
          0.233333333333334,
          0.076100766
        ],
        [
          0.236666666666667,
          0.086774174
        ],
        [
          0.240000000000001,
          0.093594542
        ],
        [
          0.243333333333334,
          0.074448894
        ],
        [
          0.246666666666667,
          0.076369792
        ],
        [
          0.250000000000001,
          0.083973044
        ],
        [
          0.253333333333334,
          0.082022078
        ],
        [
          0.256666666666667,
          0.076474416
        ],
        [
          0.260000000000001,
          0.081313352
        ],
        [
          0.263333333333334,
          0.079529446
        ],
        [
          0.268333333333334,
          0.074188616
        ],
        [
          0.271666666666667,
          0.06798402
        ],
        [
          0.275,
          0.065366752
        ],
        [
          0.278333333333334,
          0.066807312
        ],
        [
          0.281666666666667,
          0.066341754
        ],
        [
          0.285,
          0.066343104
        ],
        [
          0.288333333333334,
          0.064029504
        ],
        [
          0.291666666666667,
          0.069100432
        ],
        [
          0.295,
          0.060967866
        ],
        [
          0.298333333333333,
          0.051917474
        ],
        [
          0.301666666666667,
          0.061207936
        ],
        [
          0.305,
          0.059039946
        ],
        [
          0.31,
          0.067773752
        ],
        [
          0.313333333333333,
          0.056332928
        ],
        [
          0.316666666666667,
          0.056902252
        ],
        [
          0.32,
          0.050764324
        ],
        [
          0.323333333333333,
          0.049233802
        ],
        [
          0.326666666666666,
          0.059564972
        ],
        [
          0.33,
          0.071222702
        ],
        [
          0.333333333333333,
          0.054380582
        ],
        [
          0.336666666666666,
          0.071666786
        ],
        [
          0.34,
          0.067386364
        ],
        [
          0.343333333333333,
          0.074438776
        ],
        [
          0.346666666666666,
          0.086998242
        ],
        [
          0.351666666666666,
          0.048129172
        ],
        [
          0.355,
          0.042206844
        ],
        [
          0.358333333333333,
          0.034691292
        ],
        [
          0.361666666666666,
          0.036683826
        ],
        [
          0.364999999999999,
          0.038205592
        ],
        [
          0.368333333333333,
          0.044332328
        ],
        [
          0.371666666666666,
          0.041290568
        ],
        [
          0.374999999999999,
          0.041046944
        ],
        [
          0.378333333333333,
          0.04129468
        ],
        [
          0.381666666666666,
          0.048522646
        ],
        [
          0.384999999999999,
          0.04007642
        ],
        [
          0.388333333333333,
          0.035370972
        ],
        [
          0.393333333333332,
          0.058538648
        ],
        [
          0.396666666666666,
          0.068450208
        ],
        [
          0.399999999999999,
          0.05208389
        ],
        [
          0.403333333333332,
          0.063856682
        ],
        [
          0.406666666666666,
          0.079195466
        ],
        [
          0.409999999999999,
          0.060375056
        ],
        [
          0.413333333333332,
          0.05251243
        ],
        [
          0.416666666666666,
          0.057919474
        ],
        [
          0.419999999999999,
          0.062479528
        ],
        [
          0.423333333333332,
          0.085848632
        ],
        [
          0.426666666666665,
          0.068409902
        ],
        [
          0.429999999999999,
          0.070471764
        ],
        [
          0.434999999999999,
          0.064010884
        ],
        [
          0.438333333333332,
          0.070874764
        ],
        [
          0.441666666666665,
          0.085458458
        ],
        [
          0.444999999999999,
          0.1151598
        ],
        [
          0.448333333333332,
          0.098264886
        ],
        [
          0.451666666666665,
          0.103926196
        ],
        [
          0.454999999999999,
          0.096419676
        ],
        [
          0.458333333333332,
          0.099320694
        ],
        [
          0.461666666666665,
          0.081538298
        ],
        [
          0.464999999999998,
          0.087072224
        ],
        [
          0.468333333333332,
          0.086786226
        ],
        [
          0.471666666666665,
          0.090755578
        ],
        [
          0.476666666666665,
          0.0695923
        ],
        [
          0.479999999999998,
          0.072440268
        ],
        [
          0.483333333333332,
          0.070839146
        ],
        [
          0.486666666666665,
          0.111062614
        ],
        [
          0.489999999999998,
          0.120547588
        ],
        [
          0.493333333333331,
          0.114480012
        ],
        [
          0.496666666666665,
          0.147566356
        ],
        [
          0.499999999999998,
          0.141432184
        ],
        [
          0.503333333333331,
          0.13413587
        ],
        [
          0.506666666666665,
          0.138018584
        ],
        [
          0.509999999999998,
          0.092823864
        ],
        [
          0.513333333333332,
          0.101071188
        ],
        [
          0.518333333333332,
          0.105150416
        ],
        [
          0.521666666666665,
          0.102835436
        ],
        [
          0.524999999999999,
          0.105118922
        ],
        [
          0.528333333333332,
          0.098322628
        ],
        [
          0.531666666666665,
          0.09645792
        ],
        [
          0.534999999999999,
          0.094206554
        ],
        [
          0.538333333333332,
          0.092868584
        ],
        [
          0.541666666666666,
          0.099692152
        ],
        [
          0.544999999999999,
          0.091558858
        ],
        [
          0.548333333333332,
          0.080085784
        ],
        [
          0.551666666666666,
          0.084746874
        ],
        [
          0.554999999999999,
          0.07963973
        ],
        [
          0.559999999999999,
          0.08792069
        ],
        [
          0.563333333333333,
          0.097038344
        ],
        [
          0.566666666666666,
          0.087699246
        ],
        [
          0.57,
          0.08212368
        ],
        [
          0.573333333333333,
          0.085863792
        ],
        [
          0.576666666666666,
          0.094771162
        ],
        [
          0.58,
          0.09749201
        ],
        [
          0.583333333333333,
          0.080995894
        ],
        [
          0.586666666666667,
          0.081005096
        ],
        [
          0.59,
          0.08085049
        ],
        [
          0.593333333333333,
          0.097356396
        ],
        [
          0.596666666666667,
          0.09468653
        ],
        [
          0.601666666666667,
          0.075859148
        ],
        [
          0.605,
          0.10999774
        ],
        [
          0.608333333333334,
          0.095919028
        ],
        [
          0.611666666666667,
          0.097915224
        ],
        [
          0.615000000000001,
          0.113576766
        ],
        [
          0.618333333333334,
          0.098824102
        ],
        [
          0.621666666666667,
          0.130585866
        ],
        [
          0.625000000000001,
          0.096918352
        ],
        [
          0.628333333333334,
          0.089235268
        ],
        [
          0.631666666666668,
          0.123918744
        ],
        [
          0.635000000000001,
          0.10337368
        ],
        [
          0.638333333333335,
          0.099580396
        ],
        [
          0.643333333333335,
          0.10200415
        ],
        [
          0.646666666666668,
          0.106981894
        ],
        [
          0.650000000000001,
          0.091556734
        ],
        [
          0.653333333333335,
          0.084123812
        ],
        [
          0.656666666666668,
          0.118801852
        ],
        [
          0.660000000000002,
          0.132050904
        ],
        [
          0.663333333333335,
          0.129579634
        ],
        [
          0.666666666666669,
          0.119702398
        ],
        [
          0.670000000000002,
          0.138579668
        ],
        [
          0.673333333333335,
          0.129004628
        ],
        [
          0.676666666666669,
          0.114568892
        ],
        [
          0.680000000000002,
          0.11784425
        ],
        [
          0.685000000000002,
          0.106929028
        ],
        [
          0.688333333333336,
          0.096616004
        ],
        [
          0.691666666666669,
          0.090910354
        ],
        [
          0.695000000000003,
          0.103817442
        ],
        [
          0.698333333333336,
          0.092505858
        ],
        [
          0.701666666666669,
          0.131531098
        ],
        [
          0.705000000000003,
          0.129488188
        ],
        [
          0.708333333333336,
          0.084743372
        ],
        [
          0.71166666666667,
          0.087353054
        ],
        [
          0.715000000000003,
          0.103165322
        ],
        [
          0.718333333333336,
          0.077734212
        ],
        [
          0.72166666666667,
          0.094839706
        ],
        [
          0.72666666666667,
          0.107274464
        ],
        [
          0.730000000000003,
          0.099738008
        ],
        [
          0.733333333333337,
          0.081031946
        ],
        [
          0.73666666666667,
          0.160459944
        ],
        [
          0.740000000000004,
          0.133538788
        ],
        [
          0.743333333333337,
          0.08815583
        ],
        [
          0.74666666666667,
          0.097820664
        ],
        [
          0.750000000000004,
          0.113520894
        ],
        [
          0.753333333333337,
          0.099954742
        ],
        [
          0.756666666666671,
          0.090291362
        ],
        [
          0.760000000000004,
          0.093785216
        ],
        [
          0.763333333333337,
          0.100113252
        ],
        [
          0.768333333333338,
          0.09699985
        ],
        [
          0.771666666666671,
          0.099903698
        ],
        [
          0.775000000000004,
          0.126074604
        ],
        [
          0.778333333333338,
          0.086607852
        ],
        [
          0.781666666666671,
          0.078836908
        ],
        [
          0.785000000000005,
          0.071114846
        ],
        [
          0.788333333333338,
          0.071949132
        ],
        [
          0.791666666666671,
          0.05608937
        ],
        [
          0.795000000000005,
          0.071777246
        ],
        [
          0.798333333333338,
          0.074240064
        ],
        [
          0.801666666666672,
          0.09303625
        ],
        [
          0.805000000000005,
          0.083338716
        ],
        [
          0.810000000000005,
          0.083282054
        ],
        [
          0.813333333333339,
          0.110499292
        ],
        [
          0.816666666666672,
          0.09737593
        ],
        [
          0.820000000000005,
          0.110887764
        ],
        [
          0.823333333333339,
          0.135147224
        ],
        [
          0.826666666666672,
          0.137772206
        ],
        [
          0.830000000000006,
          0.155075366
        ],
        [
          0.833333333333339,
          0.153389322
        ],
        [
          0.836666666666672,
          0.167513334
        ],
        [
          0.840000000000006,
          0.137224728
        ],
        [
          0.843333333333339,
          0.125763046
        ],
        [
          0.846666666666673,
          0.123717714
        ],
        [
          0.851666666666673,
          0.136590558
        ],
        [
          0.855000000000006,
          0.144672078
        ],
        [
          0.85833333333334,
          0.14381943
        ],
        [
          0.861666666666673,
          0.136227102
        ],
        [
          0.865000000000006,
          0.136748542
        ],
        [
          0.86833333333334,
          0.138102316
        ],
        [
          0.871666666666673,
          0.125249176
        ],
        [
          0.875000000000007,
          0.179608978
        ],
        [
          0.87833333333334,
          0.17069586
        ],
        [
          0.881666666666673,
          0.153176172
        ],
        [
          0.885000000000007,
          0.188610348
        ],
        [
          0.88833333333334,
          0.207331748
        ],
        [
          0.89333333333334,
          0.204508232
        ],
        [
          0.896666666666674,
          0.228725022
        ],
        [
          0.900000000000007,
          0.279220428
        ],
        [
          0.903333333333341,
          0.279117122
        ],
        [
          0.906666666666674,
          0.29583066
        ],
        [
          0.910000000000007,
          0.279256286
        ],
        [
          0.913333333333341,
          0.306865292
        ],
        [
          0.916666666666674,
          0.361426456
        ],
        [
          0.920000000000008,
          0.335420924
        ],
        [
          0.923333333333341,
          0.34725681
        ],
        [
          0.926666666666675,
          0.428732626
        ],
        [
          0.930000000000008,
          0.361122366
        ],
        [
          0.935000000000008,
          0.34623368
        ],
        [
          0.938333333333341,
          0.327635116
        ],
        [
          0.941666666666675,
          0.287698668
        ],
        [
          0.945000000000008,
          0.324826034
        ],
        [
          0.948333333333342,
          0.340163734
        ],
        [
          0.951666666666675,
          0.375091534
        ],
        [
          0.955000000000009,
          0.36357243
        ],
        [
          0.958333333333342,
          0.406812058
        ],
        [
          0.961666666666675,
          0.408987516
        ],
        [
          0.965000000000009,
          0.402750944
        ],
        [
          0.968333333333342,
          0.329371778
        ],
        [
          0.971666666666676,
          0.28141041
        ],
        [
          0.976666666666676,
          0.305862584
        ],
        [
          0.980000000000009,
          0.308614434
        ],
        [
          0.983333333333342,
          0.326867658
        ],
        [
          0.986666666666676,
          0.320981404
        ],
        [
          0.990000000000009,
          0.325478032
        ],
        [
          0.993333333333343,
          0.309994716
        ],
        [
          0.996666666666676,
          0.359424626
        ]
]
